<main>
    <div class="container">
        <button (click)="openDialog()" mat-raised-button color="primary">Add Menu</button>

        <form class="example-full-width" [formGroup]="findName">
          <mat-form-field class="example-full-width" appearance="fill">
            <mat-label>name</mat-label>
            <input matInput type="text" formControlName="name" placeholder="find name ..."  />
          </mat-form-field>

          <mat-form-field appearance="fill">
            <mat-label>Status</mat-label>
            <mat-select formControlName="status">
              <mat-option *ngFor="let item of status" [value]="item">
                {{item}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </form>
        <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
            <!--- Note that these columns can be defined in any order.
                        The actual rendered columns are set as a property on the row definition" -->
        
            <!-- Position Column -->
            <ng-container matColumnDef="image">
              <th mat-header-cell *matHeaderCellDef>Image</th>
              <td mat-cell *matCellDef="let element">
                <div class="img">
                  <img [src]="element.image" alt="">
                </div>
              </td>
            </ng-container>

            <!-- Position Column -->
            <ng-container matColumnDef="name">
              <th mat-header-cell *matHeaderCellDef>Name</th>
              <td mat-cell *matCellDef="let element">{{ element.recipe_name }}</td>
            </ng-container>
        
            
            <!-- Weight Column -->
            <ng-container matColumnDef="ingredients">
                <th mat-header-cell *matHeaderCellDef>Ingrediets</th>
                <td mat-cell *matCellDef="let element">
                    <div *ngFor="let item of element.ingredients">
                        <td mat-cell>{{ item.ingredient_id.name }} ( {{ item.stock_used }} )</td>
                    </div>
                </td>
            </ng-container>
            <!-- Name Column -->
            <ng-container matColumnDef="price">
              <th mat-header-cell *matHeaderCellDef>Price</th>
              <td mat-cell *matCellDef="let element">
                Rp. {{ element.price }}
              </td>
            </ng-container>

            <ng-container matColumnDef="available">
              <th mat-header-cell *matHeaderCellDef>Available</th>
              <td mat-cell *matCellDef="let element">
                {{ element.available }}
              </td>
            </ng-container>
            
            <!-- Symbol Column -->
            <ng-container matColumnDef="status">
              <th mat-header-cell *matHeaderCellDef>Status</th>
              <td mat-cell *matCellDef="let element">
                {{ element.status }} 
                <button (click)="updateStatus({'id' : element._id,  'status' : element.status == 'draft' ? 'active' : 'draft'})" >
                   <mat-icon *ngIf="element.status == 'active' " >check</mat-icon> 
                   <mat-icon *ngIf="element.status == 'draft' " >panorama_fish_eye</mat-icon> 

                </button>
              </td>
            </ng-container>

            <ng-container matColumnDef="action" style="text-align:center!important ;">
              <th mat-header-cell *matHeaderCellDef>Action</th>
              <td mat-cell *matCellDef="let element">
                <input type="text" value="{{ element._id }}" hidden #_id>
                <input type="text" value="{{ element.recipe_name }}" hidden #name>
                <input type="text" value="{{ element.price }}" hidden #price>
                <input type="text" value="{{ element.image }}" hidden #image>
                <button [disabled]="element.status == 'active'" (click)="openEdit(_id.value, name.value, price.value, image.value, element.ingredients)" ><mat-icon>edit</mat-icon></button>
                <button [disabled]="element.status == 'active'" (click)="deleteRecipe(_id.value)" ><mat-icon>delete</mat-icon></button>
              </td>
            </ng-container>
        
        
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
        
            <tr class="mat-row" *matNoDataRow>
              <td class="mat-cell" colspan="4">
                No data matching the filter
              </td>
            </tr>
          </table>
            <mat-paginator #paginator class="promo-paginator" (page)="onPaginatorChange($event)"
                showFirstLastButtons="true">
            </mat-paginator>
    </div>
</main>